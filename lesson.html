<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson View - LearningTime VR Support</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Add specific styles for lesson view if needed */
        .lesson-container {
            display: flex;
        }
        .sidebar {
            width: 250px;
            border-right: 1px solid #eee;
            padding-right: 20px;
            margin-right: 20px;
        }
        .sidebar h2 {
            font-size: 1.2em;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .sidebar li a {
            display: block;
            padding: 10px 0;
            text-decoration: none;
            color: #333;
            /* Add active state styling */
        }
        .sidebar li a:hover {
            color: #007bff; /* Example hover color */
        }
        .lesson-content {
            flex-grow: 1;
        }
        .next-btn {
            display: inline-block;
            padding: 10px 20px;
            /* background: linear-gradient(to right, #6a11cb, #2575fc); */ /* Old gradient */
             background: linear-gradient(to right, #0052cc, #007bff); /* New blue gradient */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            text-decoration: none;
            text-align: center;
        }
        .nav-button-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        .back-link {
             text-decoration: none;
             color: #007bff; /* Example color */
        }
        .back-link:hover {
             text-decoration: underline;
        }

        /* Styling for the clickable sidebar topic */
        a.sidebar-topic-link {
            text-decoration: none; /* Remove underline */
            color: inherit; /* Use default text color */
            display: block; /* Make the link take up the h2's block space */
            cursor: pointer; /* Indicate clickability */
            border-bottom: 1px solid #eee; /* Keep the original h2 border */
            margin-bottom: 15px; /* Keep the original h2 margin */
            padding-bottom: 10px; /* Keep the original h2 padding */
        }
        a.sidebar-topic-link h2 {
            margin: 0; /* Remove default h2 margin as it's on the link */
            padding: 0; /* Remove default h2 padding */
            border: none; /* Remove default h2 border */
            font-size: 1.2em; /* Keep original h2 font-size */
            /* Inherit color and font-weight from parent link/h2 defaults */
        }
        a.sidebar-topic-link:hover h2 {
             color: #007bff; /* Example hover color, same as lesson links */
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo-link">
                <img src="assets/logo.png" alt="LearningTime VR Logo" class="logo"> <!-- Placeholder for logo -->
            </a>
            <button id="schedule-header-btn" class="schedule-btn">Schedule Virtual Training</button>
        </div>
    </header>

    <main class="container lesson-container">
        <aside class="sidebar">
            <a href="#" id="sidebar-topic-link" class="sidebar-topic-link">
                <h2 id="sidebar-topic">Topic</h2>
            </a>
            <ul id="sidebar-nav">
                <!-- Sidebar links will be populated by JS -->
                 <!-- Static links removed -->
            </ul>
        </aside>
        <section class="lesson-content">
            <h1 id="lesson-title">Lesson Title</h1>
            <div id="lesson-body">
                <!-- Lesson content will be loaded here -->
                <p>This is placeholder content for the lesson. It will be replaced dynamically or built out later.</p>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Quod, quidem asperiores? Voluptates, quasi! Quisquam, quod.</p>
            </div>
            <div style="clear:both;"></div>
        </section>
    </main>

    <div class="container">
        <hr style="margin-top: 40px; margin-bottom: 0; border: 0; border-top: 1px solid #eee;">
        <div class="nav-button-container">
             <a href="index.html" class="back-link">&larr; Back to Support Home</a>
             <a href="#" id="next-lesson-btn" class="next-btn">Next Section →</a>
        </div>
    </div>

    <footer>
        <!-- Footer content can go here -->
    </footer>

    <!-- Calendly script needed if header button is clicked from this page -->
    <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calendlyUrl = 'https://calendly.com/learningtimevr-demo/30min';

            // --- Lesson Data Structure ---
            const lessonsData = {
                'start-here': {
                    name: 'Start Here',
                    lessons: [
                        { id: 'start-here-overview', title: 'Start Here', isOverview: true, content: '<p>Welcome! This section guides you through the initial steps and essential information to begin using LearningTime VR effectively.</p><ul><li>Understand the basics with the Quick Start Guide.</li><li>Learn about ArborXR for device management.</li><li>Plan your physical space for VR activities.</li><li>Review crucial safety guidelines.</li><li>Prepare students with the introduction presentation.</li><li>Explore accessibility options.</li></ul>' },
                        { id: 'quick-start', title: 'Quick Start Guide for First-Time Users', content: '<p>Get up and running quickly:</p><ul><li>Unboxing and initial hardware check.</li><li>Basic headset controls and navigation.</li><li>Connecting to Wi-Fi.</li><li>Launching your first application via ArborXR.</li><li>Putting on and adjusting the headset for comfort.</li></ul>' },
                        { id: 'arborxr-intro', title: 'ArborXR Introduction', content: '<p>Learn about the platform used to manage your VR headsets:</p><ul><li>What is ArborXR and why do we use it?</li><li>Accessing the ArborXR dashboard.</li><li>Overview of key features: device groups, content management, monitoring.</li><li>Basic navigation within the ArborXR interface.</li></ul>' },
                        { id: 'space-planning', title: 'Classroom Space Planning', content: '<p>Ensure a safe and effective VR environment:</p><ul><li>Importance of a designated, clear VR space.</li><li>Recommended minimum dimensions per user.</li><li>Identifying and removing potential physical hazards.</li><li>Setting up the virtual boundary (guardian/chaperone).</li><li>Considerations for multi-user setups.</li></ul>' },
                        { id: 'safety', title: 'Safety Guidelines & Best Practices', content: '<p>Prioritize safety during VR use:</p><ul><li>Key safety rules: taking breaks, spatial awareness, seated vs. standing use.</li><li>Potential hazards (motion sickness, eye strain, physical obstacles).</li><li>Supervision guidelines for students.</li><li>Emergency procedures and contact information.</li></ul>' },
                        { id: 'student-intro-pres', title: 'Student Introduction Presentation', content: '<p>Prepare your students for their first VR experience:</p><ul><li>Accessing the provided presentation materials (link/location).</li><li>Key topics to cover: what VR is, safety rules, basic controls, expected behavior.</li><li>Addressing common student questions or concerns.</li><li>Setting expectations for the learning activity.</li></ul>' },
                        { id: 'accessibility', title: 'Accessibility Features & Accommodations', content: '<p>Making VR accessible for all learners:</p><ul><li>Overview of built-in accessibility options (e.g., text size, contrast, audio settings).</li><li>Controller remapping possibilities.</li><li>Software-specific accessibility features.</li><li>Strategies for accommodating diverse needs in a VR setting.</li></ul>' }
                    ]
                },
                'setup-class-management': {
                    name: 'Set Up & Class Management',
                    lessons: [
                        { id: 'setup-overview', title: 'Set Up & Class Management', isOverview: true, content: '<p>This section covers the practical aspects of integrating VR into your classroom routines and managing student use.</p><ul><li>Plan VR session timing and scheduling.</li><li>Implement effective classroom management strategies for VR.</li><li>Learn how to view student screens.</li><li>Handle common technical hiccups during class.</li><li>Maintain headset hygiene.</li><li>Properly store equipment.</li></ul>' },
                        { id: 'scheduling-time', title: 'Scheduling & Time Management', content: '<p>Integrate VR smoothly into your timetable:</p><ul><li>Strategies for fitting VR sessions into class periods.</li><li>Recommended session lengths based on age/activity.</li><li>Using booking systems or sign-up sheets (if applicable).</li><li>Planning buffer time for setup and transitions.</li></ul>' },
                        { id: 'class-strategies', title: 'Classroom Management Strategies', content: '<p>Maintain an effective learning environment during VR use:</p><ul><li>Setting clear expectations and rules for VR activities.</li><li>Techniques for keeping students focused and on task.</li><li>Managing transitions into and out of VR.</li><li>Facilitating collaboration or discussion during/after VR.</li><li>Strategies for handling off-task behavior.</li></ul>' },
                        { id: 'view-screens', title: 'View Student Screens', content: '<p>Monitor student progress and provide support:</p><ul><li>Using ArborXR casting or similar features to view student perspectives.</li><li>Steps to initiate screen viewing.</li><li>Limitations and considerations (e.g., network bandwidth, privacy).</li><li>Using screen viewing for guidance and troubleshooting.</li></ul>' },
                        { id: 'technical-issues', title: 'Handling Technical Issues', content: '<p>Address common problems quickly during class time:</p><ul><li>Recognizing frequent issues: controller drift/disconnects, tracking problems, app crashes.</li><li>Basic troubleshooting steps teachers can perform immediately.</li><li>Restarting headsets or applications.</li><li>When to escalate an issue to technical support.</li></ul>' },
                        { id: 'cleaning', title: 'Cleaning Your Headsets', content: '<p>Maintain hygiene and device longevity:</p><ul><li>Importance of regular cleaning, especially with shared devices.</li><li>Recommended cleaning materials (e.g., alcohol-free wipes, microfiber cloths).</li><li>Proper procedure for cleaning lenses, face pads, and controllers.</li><li>Frequency of cleaning recommendations.</li></ul>' },
                        { id: 'storage', title: 'Putting Headsets Away', content: '<p>Ensure devices are stored safely and correctly:</p><ul><li>Best practices for storing headsets to prevent lens damage (e.g., away from sunlight).</li><li>Organizing controllers and charging cables.</li><li>Using charging stations or storage cases effectively.</li><li>Ensuring devices are powered off or in standby mode correctly.</li></ul>' }
                    ]
                },
                'content-library': {
                    name: 'Content Library',
                    lessons: [
                        { id: 'content-overview', title: 'Content Library', isOverview: true, content: '<p>Explore the available learning applications and content for your LearningTime VR system.</p><ul><li>Managing content via ArborXR.</li><li>Discovering VXR Labs experiences.</li><li>Options for creating or using custom lesson content.</li><li>Assessing student learning within VR applications.</li><li>How to request new content titles.</li></ul>' },
                        { id: 'arborxr-content', title: 'ArborXR', content: '<p>Manage applications and experiences using ArborXR:</p><ul><li>Browsing the available content library within ArborXR.</li><li>Assigning specific applications or content bundles to device groups.</li><li>Updating applications remotely.</li><li>Removing content from headsets.</li></ul>' },
                        { id: 'vxr-labs', title: 'VXR Labs', content: '<p>Utilize the VXR Labs platform for interactive science labs:</p><ul><li>Overview of VXR Labs and its capabilities.</li><li>Accessing the VXR Labs portal or application.</li><li>Browsing available labs and simulations.</li><li>Integrating VXR Labs into your curriculum.</li><li>Teacher dashboard features (if applicable).</li></ul>' },
                        { id: 'custom-lessons', title: 'Creating Custom Lessons', content: '<p>Extend learning beyond the standard library:</p><ul><li>Possibilities for integrating custom 360-degree videos or images.</li><li>Using platforms or tools compatible with headset deployment (e.g., webVR).</li><li>Considerations for developing or commissioning custom VR applications.</li><li>Uploading and managing custom content via ArborXR (if supported).</li></ul>' },
                        { id: 'assessment', title: 'Assessment Options in VR', content: '<p>Measure student understanding and engagement:</p><ul><li>Identifying built-in assessment tools within specific VR applications (quizzes, performance tracking).</li><li>Using observational checklists during VR activities.</li><li>Employing traditional assessment methods post-VR (discussions, reports).</li><li>Potential for data logging and analytics (application-dependent).</li></ul>' },
                        { id: 'request-content', title: 'Request New Content', content: '<p>Provide feedback and suggest new applications:</p><ul><li>Process for requesting new VR titles or experiences.</li><li>Providing details about desired learning objectives or subject matter.</li><li>Channels for feedback on existing content.</li></ul>' }
                    ]
                },
                'troubleshooting-support': {
                    name: 'Troubleshooting & Support',
                    lessons: [
                        { id: 'support-overview', title: 'Troubleshooting & Support', isOverview: true, content: '<p>Find solutions to common problems and learn how to get help when needed.</p><ul><li>Addressing common technical issues.</li><li>Performing basic hardware maintenance.</li><li>Keeping software up-to-date.</li><li>Understanding warranty coverage.</li></ul>' },
                        { id: 'common-issues', title: 'Common Issues & Solutions', content: '<p>Address frequent technical challenges:</p><ul><li>Detailed troubleshooting for: tracking loss, controller pairing/connectivity issues, visual glitches, audio problems, application failures.</li><li>Understanding error messages.</li><li>Network connectivity troubleshooting (Wi-Fi).</li><li>When a factory reset might be necessary (and how to do it).</li></ul>' },
                        { id: 'hardware', title: 'Hardware Maintenance', content: '<p>Keep your VR equipment in good working order:</p><ul><li>Inspecting cables for damage.</li><li>Cleaning controller tracking rings and headset cameras/sensors.</li><li>Battery care for headsets and controllers.</li><li>Checking lens clarity and cleaning procedures (reiteration).</li><li>Recognizing signs of hardware failure.</li></ul>' },
                        { id: 'software-updates', title: 'Software Updates', content: '<p>Ensure optimal performance and security:</p><ul><li>Importance of keeping headset OS and applications updated.</li><li>Checking for updates via ArborXR or device settings.</li><li>Scheduling or performing updates.</li><li>Troubleshooting update failures.</li></ul>' },
                        { id: 'warranty', title: 'Warranty Information', content: '<p>Understand your coverage and support options:</p><ul><li>How to find warranty period and terms for your hardware.</li><li>Process for registering devices (if required).</li><li>How to initiate a support request or warranty claim.</li><li>Contact information for LearningTime VR support.</li></ul>' }
                    ]
                }
            };

            // Define the order of topics for navigation
            const topicOrder = ['start-here', 'setup-class-management', 'content-library', 'troubleshooting-support'];

            // --- Elements ---
            const sidebarNav = document.getElementById('sidebar-nav');
            const sidebarTopicEl = document.getElementById('sidebar-topic');
            const lessonTitleEl = document.getElementById('lesson-title');
            const lessonBodyEl = document.getElementById('lesson-body');
            const nextBtn = document.getElementById('next-lesson-btn');
            const scheduleHeaderBtn = document.getElementById('schedule-header-btn');
            const sidebarTopicLink = document.getElementById('sidebar-topic-link');

            // --- Calendly --- (Keep existing logic)
            function openCalendly(url) {
                Calendly.initPopupWidget({ url: url });
                return false;
            }
            if (scheduleHeaderBtn) {
                scheduleHeaderBtn.addEventListener('click', () => openCalendly(calendlyUrl));
            }

            // --- Lesson Loading and Sidebar Population ---
            const urlParams = new URLSearchParams(window.location.search);
            const currentTopicId = urlParams.get('topic') || topicOrder[0]; // Default to first topic
            const currentTopicData = lessonsData[currentTopicId];
            let currentLessonIndex = 0;

            function loadLesson(lessonIndex) {
                if (!currentTopicData || !currentTopicData.lessons[lessonIndex]) return;

                const lesson = currentTopicData.lessons[lessonIndex];
                lessonTitleEl.textContent = lesson.title;

                // Handle overview pages
                if (lesson.isOverview) {
                    // Use content defined in lessonsData for overview
                    lessonBodyEl.innerHTML = lesson.content || `<p>Overview of the <strong>${currentTopicData.name}</strong> section. Select a lesson from the sidebar to get started.</p>`; // Fallback if content is missing
                } else {
                    // Use content defined in lessonsData for regular lessons
                    lessonBodyEl.innerHTML = lesson.content || `<p>Content for <strong>${lesson.title}</strong> goes here. This is a placeholder.</p>`; // Fallback if content is missing
                }

                currentLessonIndex = lessonIndex;

                // Update active state in sidebar
                const sidebarLinks = document.querySelectorAll('#sidebar-nav li a');
                sidebarLinks.forEach((link, sidebarIndex) => {
                    if (lesson.isOverview) {
                        // If showing overview, no sidebar link should be active
                        link.classList.remove('active');
                    } else {
                        // If showing a real lesson, activate the corresponding sidebar link
                        // The sidebar index is lessonIndex - 1 because the overview is skipped
                        link.classList.toggle('active', sidebarIndex === lessonIndex - 1);
                    }
                });

                // --- Update Next button state and text ---
                const isLastLesson = lessonIndex >= currentTopicData.lessons.length - 1;
                const currentTopicOrderIndex = topicOrder.indexOf(currentTopicId);
                const isLastTopic = currentTopicOrderIndex >= topicOrder.length - 1;

                if (isLastLesson) {
                    if (isLastTopic) {
                        nextBtn.style.display = 'none'; // Hide on last lesson of last topic
                    } else {
                        // Show "Next Topic" button
                        const nextTopicId = topicOrder[currentTopicOrderIndex + 1];
                        const nextTopicName = lessonsData[nextTopicId]?.name || 'Next Topic';
                        nextBtn.textContent = `Next Topic: ${nextTopicName} →`;
                        nextBtn.style.display = 'inline-block';
                        nextBtn.setAttribute('data-action', 'next-topic'); // Mark action type
                        nextBtn.setAttribute('data-next-topic', nextTopicId); // Store next topic id
                    }
                } else {
                    // Show "Next Section" button
                    nextBtn.textContent = 'Next Section →';
                    nextBtn.style.display = 'inline-block';
                     nextBtn.setAttribute('data-action', 'next-section'); // Mark action type
                     nextBtn.removeAttribute('data-next-topic');
                }
            }

            function populateSidebar() {
                if (!currentTopicData) {
                    sidebarTopicEl.textContent = 'Unknown Topic';
                    lessonTitleEl.textContent = 'Content not found';
                    lessonBodyEl.innerHTML = '<p>Please select a topic from the Support Home page.</p>';
                    sidebarNav.innerHTML = '';
                     nextBtn.style.display = 'none';
                    return;
                }

                sidebarTopicEl.textContent = currentTopicData.name;
                sidebarNav.innerHTML = ''; // Clear existing static or old items

                currentTopicData.lessons.forEach((lesson, index) => {
                    // Skip creating a sidebar link for the overview page itself
                    if (lesson.isOverview) {
                        return; // Skip this iteration
                    }

                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.href = `#${lesson.id}`; // Use hash for potential deep linking / identification
                    a.textContent = lesson.title;
                    a.addEventListener('click', (e) => {
                        e.preventDefault(); // Prevent page jump
                        loadLesson(index);
                    });
                    li.appendChild(a);
                    sidebarNav.appendChild(li);
                });

                // Load the first lesson initially
                loadLesson(0);
            }

            // --- Next Button Logic ---
            if(nextBtn) {
                nextBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const action = nextBtn.getAttribute('data-action');

                    if (action === 'next-section') {
                        const nextLessonDataIndex = currentLessonIndex + 1;
                        if (currentTopicData && nextLessonDataIndex < currentTopicData.lessons.length) {
                            // The sidebar link to click corresponds to the *current* lesson index
                            // because the sidebar link list is 1 shorter than the lessons list (due to skipping the overview)
                            // When currentLessonIndex is 0 (overview), we click sidebar link 0.
                            // When currentLessonIndex is 1 (first real lesson), we click sidebar link 1, etc.
                            const nextSidebarLinkIndex = currentLessonIndex;
                            const nextLink = sidebarNav.querySelectorAll('li a')[nextSidebarLinkIndex];
                            if (nextLink) {
                                nextLink.click();
                            } else {
                                console.error("Could not find next sidebar link at index:", nextSidebarLinkIndex);
                            }
                        }
                    } else if (action === 'next-topic') {
                        const nextTopicId = nextBtn.getAttribute('data-next-topic');
                        if (nextTopicId) {
                            window.location.href = `lesson.html?topic=${nextTopicId}`;
                        }
                    }
                });
            }

            // --- Sidebar Topic Link --- Add listener for the topic link
            if (sidebarTopicLink) {
                sidebarTopicLink.addEventListener('click', function(e) {
                    e.preventDefault(); // Prevent default anchor behavior
                    loadLesson(0); // Load the overview page (index 0)
                });
            }

            // --- Initial Load ---
            populateSidebar();

        });
    </script>
</body>
</html> 